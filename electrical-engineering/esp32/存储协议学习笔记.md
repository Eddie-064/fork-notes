# 存储协议学习笔记

- SD 卡（Secure Digital）
- eMMC（Embedded Multi Media Card）
- UFS
- NVMe
- Sata3.0

SD 即 Secure Digital 的缩写，意即安全数字卡，是一种安全闪存存储卡，由美国的非盈利组织 SD 协会 (SDA) 制定标准。

SD 卡的另一类竞品即为 eMMC（Embedded Multi Media Card），这类存储芯片目前在 SBC 单板计算机上比较常见。以前手机内置存储大都也是 eMMC，但现在基本已经被 UFS 取代。

eMMC闪存相比UFS要慢的多得多，eMMC的结构性质（只支持半双工运行，即读写必须分开执行），这一属性决定了eMMC不会有超人的成绩，最强的eMMC5.1持续读写成绩也不过280MB/s左右。总体相当于陈旧的SATA2.0固态硬盘，写入速度上普遍只有200MB/s，与机械硬盘无异。

UFS闪存就快的多了，它的物理结构却是由多个闪存芯片、主控、缓存组成的阵列式存储模块，支持全双工运行，可同时执行读写操作，并且支持指令队列。

目前UFS闪存已经经过了UFS2.0、UFS2.1、UFS3.0、UFS3.1四个版本迭代。第一代UFS闪存UFS2.0的常见顺序读取速度为500MB/s，不过顺序写入速度提升不大，依旧在250MB/s徘徊。总体性能可以堪比目前电脑上的SATA3.0固态硬盘。UFS2.1的常见顺序读取速度为700MB/s，顺序写入依旧没什么提升，UFS2.1和UFS2.0的差距不算显著。

UFS3.0就快多了，常见的UFS3.0的顺序读取速度为1500MB/s左右。顺序写入速度可以达到500MB/s左右。UFS3.1的顺序读取速度在1800MB/s左右。顺序写入速度也进一步升级到了800MB/s。当然这些也只是常见数值，一些优秀的厂家可以调校的更好。UFS3.1的性能已经可以和普通的PCIe3.0*4的中低端固态硬盘掰手腕了。还是十分出色的。

但是要真的比起来，安卓阵营采用的UFS闪存还是稍逊于隔壁苹果的NVMe闪存，隔壁苹果早在iPhone6s时代就应用了NVMe闪存，不过当时的速度甚至还不如目前的eMMC强，目前在iPad Pro以及iPhone 11上应用的NVMe的顺序写入速度超过现在的UFS3.0闪存，随机读写性能上稍逊于UFS3.0。

总而言之，目前手机上的闪存芯片的读写性能仅有PCIe3.0*4的固态硬盘水平，并且还是中低端的那种，手机闪存想要超过电脑，还远得很呢。跟PCIe4.0*4比起来根本不够看。

以接口版本划分，SD卡可分为普通速度、高速度以及UHS-I、UHS-II。接口版本制约了该存储卡的最大存储带宽，但并不代表存储卡能实际达到这样高的速度。UHS-I标准规定了最低50MB/s，可选104MB/s的最大带宽，换句话说使用UHS-I接口的SD卡最高读取不会超过104MB/s。UHS只是接口版本规范，决定了最大带宽，但并非实际工作速度的标称。

UHS-II增加了全新的针脚定义，接口带宽最高可达到312MB/s，UHS-II存储卡向下兼容UHS-I设备，不过在UHS-I设备上使用时会被限制到UHS-I的最大带宽。

以写入速度划分，SD卡有Class等级与UHS速度等级两种速度标识方法。Class等级用于普通速度和HS高速类型接口的SD卡。UHS则有两个速度等级：UHS Speed Class 1（U1）和UHS Speed Class 3（U3），分别对应最低持续写入10MB/s和30MB/s以上。

在Class速度等级与UHS速度等级之外，SD卡协会今年又提出了一个新的视频速度等级，覆盖了现有的Class 6、U1（Class 10）、U3三种规格，又额外增加了60MB/s写入速度的V60以及90MB/s的V90规格，其中V90是专为8K视频录制而设。

虽然新速度标识的出现是为了给消费者提供选购参考，但在新的速度标识出现的同时，旧的划分标准并未取消，这使得SD卡上的标识可能会越来越多，使得一些不熟悉的人产生迷惑。

TODO

## 市面上的读卡器

首先最便宜的那种，肯定不支持 UHS-I，插再牛逼的卡，速度也破不了 10M/s（比如川宇最便宜的 9.9 二合一读卡器）.

稍微贵一点的，30 块以内的读卡器，基本都只支持到 UHS-I，写入能到 50M/s 就谢天谢地了（比如川宇卖最火爆的 USB3.0 二合一读卡器，不到 20 块钱），到这个级别，读写时卡就已经比较烫手了。

更好一点的支持 UHS-II 的读卡器，比如川宇 51 块钱的 UHS-II 读卡器，最高就能跑到 260M/s 的读取速度了，写也有 TF 卡 100M/s、SD 卡 200M/S，不过到这个级别估计卡片就更烫手了。（但是目前貌似主流的 TF 卡都仅支持到 UHS-I，而且前提是使用 9 针的卡套，纯 8 针的 TF 卡，写速度还要砍半）

川宇更牛逼的是 89 块钱的 CFast2.0 读卡器，能跑到 500M/s，仅支持 CFast2.0 协议。

川宇最贵的 289 的读卡器，仅支持 CFexpress 卡，已经需要铝合金散热槽了。官放实测写能到 750M/s，读能到 880M/s。

TODO
